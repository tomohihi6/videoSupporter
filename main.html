<!doctype html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ここにタイトル</title>
<link href="./css/main.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.0/themes/base/jquery-ui.css" />
<script src="http://code.jquery.com/jquery-1.8.3.js"></script>
<script src="http://code.jquery.com/ui/1.10.0/jquery-ui.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.32.0/codemirror.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.32.0/codemirror.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.32.0/mode/javascript/javascript.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.32.0/addon/edit/closebrackets.min.js"></script>
<script type="text/javascript" src="./fetchInfoFromYouTube.js"></script>
<script type="text/javascript" src="./main.js"></script>
<script>
    $(function() {
        $('#time-line-handle').draggable({
            axis: 'x',
            containment: '#canvas',
            drag: function (e, ui) {
                seekVideo(e)
            }
        });
    })
</script>
</head>

<body>
<div id="main">
    <div id="container">
        <div id="video-source-container">
            <div id="video-container">
                <div id="video">
                    <div id="player"></div>
                </div>
            </div>
            <div id="source-container">
                <!-- <div id="source-name" class="name">
                    main source
                </div> -->
                <div id="source">
                    <div class="tab_wrap">
                        <input id="tab1" type="radio" name="tab_btn" checked>
                        <input id="tab2" type="radio" name="tab_btn"> 

                        <div class="tab_area">
                            <label class="tab1_label" for="tab1">元ソース</label>
                            <label class="tab2_label" for="tab2">srt.js編集</label>
                        </div>
                        <div class="panel_area" id="panel_area">
                            <div id="panel1"  class='tab_panel'>
                                <textarea id="copy-source-area"></textarea>
                            </div>
                            <div id="panel2">
                                <textarea id="srt-source-area"></textarea>       
                            </div>

                    </div>
                </div>
        </div>
        </div>
        </div>
        <div id="timeline-container">
            <div id="timeline-body">
                <div id="timeline-header-ruler">
                    <canvas id="canvas"></canvas>
                    <div id="time-line-handle" style="top: 0px; left: 0px;">
                        <div id="handle-time">00:00</div>
                    </div>

                </div>

            </div>
        </div>
        <button onclick="gatherTextsFromScriptItems()">save</button>
    </div>
</div>
<script>
    window.onload = function() {
        const panel2 = document.getElementById("panel2")
        panel2.classList.add('tab_panel');
    }
    const canvas = document.getElementById("canvas");
    const handle = document.getElementById("time-line-handle");
    canvas.onmousedown = (e => {
        seekVideo(e);
    });
    handle.ondblclick = (e => {
        addScriptItem(e);
    })

    const option = {
        mode:"javascript", // 言語を設定する
        lineNumbers: true,　 // 行番号を表示する
        lineWrapping: true,　 // 行を折り返す
        autoCloseBrackets: true,
    }

    let editor = CodeMirror.fromTextArea(document.getElementById("copy-source-area"),option);
    let editor2 = CodeMirror.fromTextArea(document.getElementById("srt-source-area"),option);
    // editor2.on('change', function(e) {
    //     const value = editor2.getDoc().getValue();
    //     nowEditing.innerText = value;
    //     console.log(isEdit)
    // })
    editor2.on('change', saveTextToScriptItem);
    editor2.on('blur', function(e) {
        isEdit = false;
    })
    editor.setSize('100%', '80%');
    editor2.setSize('100%', '80%');
</script>
</body>
</html>